<div class="all">
    <app-header [view]="'admin'" [isDataRetrieved]="this.isDataRetrieved" [msgs]="this.msgs"></app-header>
    <p-splitter [style]="{display: 'flex'}" [panelSizes]="this.panelSizes">
        <ng-template pTemplate>
            <div class="flex flex-column flex-grow-1">
                <!-- DROP ZONE -->

                <div class="collections">
                    <ng-template ngFor let-collection [ngForOf]="this.collections" let-i="index">
                        <div class="dropZone" pDroppable="loaded" (onDrop)="drop(collection.label)">
                            <span><h3>{{collection.value}}{{collection.label}}</h3></span>
                            
                            <span *ngIf="this.dropped.length == 0">drop here</span>

                            <ng-template ngFor let-im [ngForOf]="this.dropped[collection.label]" let-i="index">
                                <div class="imDiv flex flex-column" (click)="this.editImage(im)">
                                    <!-- <img class="im" src="{{ im.b64 }}"> -->
                                    <span>
                                        <h3 class="imTitle">{{im.title}}</h3>
                                    </span>
                                </div>
                            </ng-template>
                        </div>
                    </ng-template>
                </div>
                

                <!-- UPLOAD FORM -->
                <div class="flex">
                    <form [formGroup]="uploadForm" (submit)="uploadToBackend()">
                    <div class="uploadForm">
                        <div class="uploadField">
                            <label for="fileNames">fileNames</label>
                            <input multiple id="fileNames" type="file" class="file-upload" (change)="loadedFiles($event)"
                                formControlName="fileNames">
                        </div>
                        <div>
                            <button [attr.disabled]="this.isDroppedEmpty() ? true : null" type="submit">UPLOAD</button>
                        </div>
                    </div>
                    </form>
                </div>
                <div>
                    <p-progressBar [value]="this.syncProgress"></p-progressBar>
                </div>

                <!-- LOADED FILES -->
                <div>
                    <button [attr.disabled]="!this.uploadView ? null : true" (click)="this.switch()">SHOW FILES TO UPLOAD</button>
                    <button [attr.disabled]="this.uploadView ? null : true" (click)="this.switch()">SHOW REMOVED IMAGES</button>
                </div>
                <div class="flex align-items-center justify-content-center">
                    <span>{{this.uploadView ? 'Files to upload:' : 'Removed images:'}}</span>
                </div>
                <div class="gallery" >
                    <div *ngIf="this.uploadView && this.files.length == 0"> Upload images from your device </div>
                    <div *ngIf="!this.uploadView && this.noCollection.length == 0"> No removed images </div>
                    <ng-template ngFor let-im [ngForOf]="this.uploadView ? this.loadedImages : this.noCollection" let-i="index">
                        <div class="imDiv" pDraggable="loaded" (onDragStart)="dragStart(im)" (onDragEnd)="dragEnd()">
                            <div class="flex flex-column" (click)="this.editImage(im)" >
                                <img class="im" src="{{ im.b64 }}">
                                <span><h3>{{im.title}}</h3></span>
                            </div>
                        </div>
                    </ng-template>
                </div>
            </div>
        </ng-template>
        <!-- EDIT ZONE -->
        <ng-template  pTemplate>
            <div  *ngIf="this.showIm" class="editZone">
                <div class="editImage" pDraggable="loaded" (onDragStart)="dragStart(this.image)" (onDragEnd)="dragEnd()">
                    <img class="imEdit" src="{{ this.image.b64 }}">
                </div>
                <div class="editForm">
                    <form [formGroup]="editForm" class="editForm">
                        <div class="editField">
                            <label for="title">title</label>
                            <input required class="editTitle" type="text" formControlName="title" (input)="onEdit()">
                        </div>
                        <div class="editField">
                            <label for="keywords">keywords</label>
                            <p-chips class="editTitle"  formControlName="keywords"></p-chips>
                        </div>
                    </form>
                </div>
            </div>
        </ng-template>
    </p-splitter>
</div>